<!DOCTYPE html>
<html>
<head lang="pl">
    <meta charset="UTF-8">
    <title>BLAST demo</title>
    <link href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
</head>
<body>
<script type="text/x-handlebars">
    <nav class="navbar navbar-default">
        <div class="container-fluid">
            <div class="navbar-header">
                {{link-to 'BLAST' 'index' class="navbar-brand"}}
            </div>
            <ul class="nav navbar-nav">
                {{#link-to 'configuration' tagName="li"}}
                <a href="#" {{bind-attr href="view.href"}}>Configuration</a>
                {{/link-to}}
                {{#each stage in stages}}
                {{#link-to stage.resource tagName="li" disabled=stage.disabled}}
                <a href="#" {{bind-attr href="view.href"}}>{{stage.name}}</a>
                {{/link-to}}
                {{/each}}
                {{#link-to 'about' tagName="li"}}
                <a href="#" {{bind-attr href="view.href"}}>About</a>
                {{/link-to}}
            </ul>
        </div>
    </nav>
    <div style="margin-bottom: 70px;">
    {{outlet}}
    </div>

    <div id="stage-navigator" class="btn-group" style="position: fixed; bottom: 0; height: 50px; background-color: #fff; display: block; width: 100%;">
        <button {{action 'prevStage'}} {{bind-attr disabled=prevStageButtonDisabled}} class="btn btn-default">Previous stage</button>
        <button {{action 'resetStage'}} {{bind-attr disabled=resetStageButtonDisabled}} class="btn btn-default">Reset stage</button>
        <button {{action 'nextStep'}} {{bind-attr disabled=nextStepButtonDisabled}} class="btn btn-default">Next step</button>
        <button {{action 'nextStage'}} {{bind-attr disabled=nextStageButtonDisabled}} class="btn btn-default">Next stage</button>
    </div>
</script>

<script type="text/x-handlebars" id="configuration">
    <div class="form-horizontal col-md-7">
        <div class="form-group">
            <label class="col-sm-3 control-label">Query sequence</label>
            <div class="col-sm-9">
                {{input value=query.sequence placeholder="Type a DNA sequence" required=true class="form-control"}}
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">Word length</label>
            <div class="col-sm-3">
                {{input value=controllers.application.wordLength size=2 placeholder="Set length of a word" required=true class="form-control"}}
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">Score drop off</label>
            <div class="col-sm-3">
                {{input value=controllers.application.scoreDropOff size=4 placeholder="Set minimal scoring threshold" required=true class="form-control"}}
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">DNA database records</label>
            <div class="col-sm-9">
                <ul class="list-group">
                    {{#each record in records}}
                    <li class="list-group-item">{{record.sequence}}<span class="pull-right"><a {{action 'removeRecordSequence' record}}><span class="glyphicon glyphicon-trash"></span></a></span></li>
                    {{else}}
                    <comment>There is no database records</comment>
                    {{/each}}
                </ul>
                {{input value=newSequenceRecord placeholder="Type a new DNA database record" class="form-control"}}
                <br/>
                <div class="btn-group">
                    <button {{action 'addRecordSequence'}} class="btn btn-primary">Add record</button>
                    <button {{action 'removeAllRecords'}} class="btn btn-danger">Remove all records</button>
                </div>
            </div>
        </div>
    </div>
    <div class="form-horizontal col-md-5">
        <div class="form-group">
            <label class="col-sm-3 control-label">Scoring matrix</label>
            {{scoring-matrix symbols=symbols scoring=scoring disabled=false class="col-sm-9"}}
        </div>
    </div>
</script>

<script type="text/x-handlebars" id="init">
    <div class="form-horizontal">
        <div class="form-group">
            <label class="col-sm-1 control-label">Word length</label>
            <div class="col-sm-1">
                {{input value=controllers.application.wordLength size=2 disabled=true class="form-control"}}
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-1 control-label">Words</label>
            <div class="col-sm-11">
                    <pre>Query: {{query.sequence}}
       {{#each word in words}}{{make-offset word.startOffset}}{{word.symbols}}
       {{/each}}</pre>
            </div>
        </div>
    </div>
</script>

<script type="text/x-handlebars" id="search">
    <div class="form-horizontal">
        {{#each wordRecordGroup in wordRecordGroups}}
            {{word-search wordRecordGroup=wordRecordGroup}}
        {{/each}}
    </div>
</script>

<script type="text/x-handlebars" id="extend">
    <div class="form-horizontal">
        <div class="form-group">
            <label class="col-sm-1 control-label">Scoring matrix</label>
            {{scoring-matrix symbols=symbols scoring=scoring disabled=true class="col-sm-9"}}
        </div>
    {{#each wordGroup in wordGroups}}
        {{#if wordGroup.matchedRecords}}
        <div class="form-group">
            <label class="col-sm-1 control-label">Word</label>
            <div class="col-sm-1">
                {{input value=wordGroup.word.symbols disabled=true class="form-control"}}
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-1 control-label">Matched records</label>
            <div class="col-sm-11">
                {{#each record in wordGroup.matchedRecords}}
                {{record-extension record=record word=wordGroup.word}}
                {{/each}}
            </div>
        </div>
        {{/if}}
    {{/each}}
    </div>
</script>

<script type="text/x-handlebars" id="results">
    <div class="form-horizontal">
        <div class="form-group">
            <label class="col-sm-1 control-label">Query sequence</label>
            <div class="col-sm-3">
                {{input value=query.sequence disabled=true class="form-control"}}
            </div>
        </div>
        <div class="form-group">
        <label class="col-sm-1 control-label">Best matching results</label>
            <div class="col-sm-1">
                <ul class="list-group">
                    {{#each result in results}}
                        {{result-item result=result}}
                    {{else}}
                        <comment>(no matches)</comment>
                    {{/each}}
                </ul>
            </div>
        </div>
    </div>
</script>

<script type="text/x-handlebars" id="about">
    This Web application presents BLAST algorithm for DNA sequences matching...
</script>

<script type="text/x-handlebars" id="components/scoring-matrix">
    <table>
        <thead>
        <tr>
            <th></th>
            {{#each header in columnHeaders}}
            <th><label class="control-label">{{header}}</label></th>
            {{/each}}
        </tr>
        </thead>
        <tbody>
        {{#each row in matrixRows}}
        <tr>
            <td><label class="matrix-row-header">{{row.rowHeader}}</label></td>
            {{#each value in row.values}}
            <td>{{input size=3 value=value.score class="form-control" disabled=disabled}}</td>
            {{/each}}
        </tr>
        {{/each}}
        </tbody>
    </table>
</script>

<script type="text/x-handlebars" id="components/word-search">
    <div class="form-group">
        <label class="col-sm-1 control-label">Word</label>
        <div class="col-sm-1">
            {{input value=wordRecordGroup.word.symbols disabled=true class="form-control"}}
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-1 control-label">Matched records</label>
        <div class="col-sm-9">
            <ul class="list-group">
                {{#each result in wordRecordGroup.matchedRecords}}
                {{result-item result=result}}
                {{else}}
                <comment>(no matches)</comment>
                {{/each}}
            </ul>
        </div>
    </div>
    {{#if wordRecordGroup.recordsToCheck}}
    <div class="form-group">
        <label class="col-sm-1 control-label">Records to check</label>
        <div class="col-sm-9">
            <ul class="list-group">
                {{#each record in wordRecordGroup.recordsToCheck}}
                <li class="list-group-item">{{record.sequence}}</li>
                {{else}}
                <comment>There is no database records</comment>
                {{/each}}
            </ul>
        </div>
    </div>
    {{/if}}
</script>

<script type="text/x-handlebars" id="components/record-extension">
Record:         {{sequencePrefixView}}{{highlight sequenceMatchView}}{{sequenceSuffixView}}
Query:          {{queryPrefixView}}{{highlight queryMatchView}}{{querySuffixView}}
Score:          {{scoreView}}
Drop off score: {{dropOffView}}
</script>

<script type="text/x-handlebars" id="components/result-item">
    {{prefix}}{{highlight match}}{{suffix}}
</script>

<script type="text/javascript" src="js/ext/jquery-1.10.2.js"></script>
<script type="text/javascript" src="js/ext/handlebars-1.1.2.js"></script>
<script type="text/javascript" src="js/ext/ember-1.7.0.js"></script>
<script type="text/javascript" src="js/ext/ember-data.js"></script>
<script type="text/javascript" src="js/application.js"></script>
<script type="text/javascript" src="js/helpers.js"></script>
<script type="text/javascript" src="js/components.js"></script>
<script type="text/javascript" src="js/model.js"></script>
<script type="text/javascript" src="js/nucleotid.js"></script>
<script type="text/javascript" src="js/fixtures.js"></script>
<!-- to activate the test runner, add the "?test" query string parameter -->
<script src="tests/runner.js"></script>
</body>
</html>
